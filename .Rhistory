prev <- predict(modVAR, n.ahead = NROW(test))
italy_prev <- prev$fcst$Italy[,1]
plot(as.numeric(test[, "Italy"]), type = "l", ylim = c(220000, 280000))
lines(italy_prev, col = 2)
setwd("C:/Users/pietr/OneDrive - Università degli Studi di Padova/UNI/Corsi/Magistrale/Secondo Anno/Primo semestre/Modelli statistici per dati economici/Lab/Simulazione prova pratica-20250528")
library(readxl)
library(urca)
library(readxl)
library(urca)
m3 <- read_xlsx("3M.xlsx")
head(m3)
m3 <- read_xlsx("3M.xlsx")
low = ts(m3$Low)
high = ts(m3$High)
head(low)
low
high
par(mfrow = c(2,3))
plot(low, main = "low")
acf(low, main = "low")
pacf(low, main = "low")
plot(high, main = "high")
acf(high, main = "high")
pacf(high, main = "high")
par(mfrow = c(1,1))
par(mfrow = c(1,1))
ccf(low, high)
library(dplyr)
library(dplyr)
?ur.df
summary(ur.df(low, type = "trend", lags = 12,
selectlags = "BIC"))
warnings()
ccf(low, high.ts)
library(readxl)
library(urca)
library(dplyr)
library(readxl)
library(urca)
library(dplyr)
m3 <- read_xlsx("3M.xlsx")
low.ts = ts(m3$low.ts)
m3 <- read_xlsx("3M.xlsx")
low.ts = ts(m3$low)
m3 <- read_xlsx("3M.xlsx")
low.ts = ts(m3$low)
setwd("C:/Users/pietr/OneDrive - Università degli Studi di Padova/UNI/Corsi/Magistrale/Secondo Anno/Primo semestre/Modelli statistici per dati economici/Lab/Simulazione prova pratica-20250528")
library(readxl)
library(urca)
library(dplyr)
m3 <- read_xlsx("3M.xlsx")
low.ts = ts(m3$low)
m3 <- read_xlsx("3M.xlsx")
low.ts = ts(m3$Low)
high.ts = ts(m3$High)
par(mfrow = c(2,3))
plot(low.ts, main = "low.ts")
acf(low.ts, main = "low.ts")
pacf(low.ts, main = "low.ts")
plot(high.ts, main = "high.ts")
acf(high.ts, main = "high.ts")
pacf(high.ts, main = "high.ts")
par(mfrow = c(1,1))
ccf(low.ts, high.ts)
summary(ur.df(low.ts, type = "trend", lags = 12,
selectlags = "BIC"))
summary(ur.df(low.ts, type = "drift", lags = 12,
selectlags = "BIC"))
summary(ur.df(low.ts, type = "none", lags = 12,
selectlags = "BIC"))
summary(ur.df(diff(low.ts), type = "none", lags = 1))
m3 <- read_xlsx("3M.xlsx")
low.ts = ts(log(m3$Low))
high.ts = ts(log(m3$High))
par(mfrow = c(2,3))
plot(low.ts, main = "low.ts")
acf(low.ts, main = "low.ts")
pacf(low.ts, main = "low.ts")
plot(high.ts, main = "high.ts")
acf(high.ts, main = "high.ts")
pacf(high.ts, main = "high.ts")
par(mfrow = c(1,1))
ccf(low.ts, high.ts)
summary(ur.df(low.ts, type = "trend", lags = 12,
selectlags = "BIC"))
summary(ur.df(low.ts, type = "drift", lags = 12,
selectlags = "BIC"))
summary(ur.df(low.ts, type = "none", lags = 12,
selectlags = "BIC"))
summary(ur.df(diff(low.ts), type = "none", lags = 1))
summary(ur.df(high.ts, type = "trend", lags = 12,
selectlags = "BIC"))
summary(ur.df(high.ts, type = "drift", lags = 12,
selectlags = "BIC"))
summary(ur.df(high.ts, type = "none", lags = 12,
selectlags = "BIC"))
summary(ur.df(diff(high.ts), type = "none", lags = 1))
library(readxl)
library(urca)
library(dplyr)
rm(list = ls())
m3 <- read_xlsx("3M.xlsx")
low.ts = ts(log(m3$Low))
high.ts = ts(log(m3$High))
par(mfrow = c(2,3))
plot(low.ts, main = "low.ts")
acf(low.ts, main = "low.ts")
pacf(low.ts, main = "low.ts")
plot(high.ts, main = "high.ts")
acf(high.ts, main = "high.ts")
pacf(high.ts, main = "high.ts")
par(mfrow = c(1,1))
ccf(low.ts, high.ts)
summary(ur.df(low.ts, type = "trend", lags = 12,
selectlags = "BIC"))
summary(ur.df(low.ts, type = "drift", lags = 12,
selectlags = "BIC"))
summary(ur.df(low.ts, type = "none", lags = 12,
selectlags = "BIC"))
summary(ur.df(diff(low.ts), type = "none", lags = 1))
summary(ur.df(high.ts, type = "trend", lags = 12,
selectlags = "BIC"))
summary(ur.df(high.ts, type = "drift", lags = 12,
selectlags = "BIC"))
summary(ur.df(high.ts, type = "none", lags = 12,
selectlags = "BIC"))
summary(ur.df(diff(high.ts), type = "none", lags = 1))
ols.
ols.fit = lm(low.ts ~ high.ts)
library(dynlm)
lagmax = ceiling(1/3 * length(low.ts)^(1/3))
lagmax
ols.fit = lm(low.ts ~ high.ts)
# scegliamo il ritardo massimo euristicamente
lagmax = ceiling(1/3 * length(low.ts)^(1/3))
dlos.fit = dynlm(low.ts ~ L(high.ts, -lagmax:lagmax))
res.ols = residuals(ols.fit)
res.dols = residuals(dols.fit)
dlos.fit = dynlm(low.ts ~ L(high.ts, -lagmax:lagmax))
res.dols = residuals(dols.fit)
dols.fit = dynlm(low.ts ~ L(high.ts, -lagmax:lagmax))
res.dols = residuals(dols.fit)
par(mfrow = c(3,1))
plot(res.ols, main = "res ols")
acf(res.ols, main = "res ols")
pacf(res.ols, main = "res ols")
par(mfrow = c(1,1))
par(mfrow = c(3,1))
plot(res.ols, main = "res ols")
acf(res.ols, main = "res ols")
pacf(res.ols, main = "res ols")
par(mfrow = c(1,1))
res.ols = ts(residuals(ols.fit))
res.dols = ts(residuals(dols.fit))
par(mfrow = c(3,1))
plot(res.ols, main = "res ols")
acf(res.ols, main = "res ols")
pacf(res.ols, main = "res ols")
par(mfrow = c(1,1))
par(mfrow = c(3,1))
plot(res.dols, main = "res dols")
acf(res.dols, main = "res dols")
pacf(res.dols, main = "res dols")
par(mfrow = c(1,1))
ols.fit %>% summary
dols.fit %>% summary
ols.fit = lm(low.ts ~ high.ts)
res.ols = ts(residuals(ols.fit))
# scegliamo il ritardo massimo euristicamente
lagmax = ceiling(1/3 * length(low.ts)^(1/3))
dols.fit = dynlm(low.ts ~ high.ts + L(res.ols, -lagmax:lagmax))
res.dols = ts(residuals(dols.fit))
par(mfrow = c(3,1))
plot(res.ols, main = "res ols")
acf(res.ols, main = "res ols")
pacf(res.ols, main = "res ols")
par(mfrow = c(1,1))
par(mfrow = c(3,1))
plot(res.dols, main = "res dols")
acf(res.dols, main = "res dols")
pacf(res.dols, main = "res dols")
par(mfrow = c(1,1))
head(res.dols)
ols.fit %>% summary
dols.fit %>% summary
summary(ur.df(res.ols, type = "trend"))
summary(ur.df(res.ols, type = "trend",
selectlags = "BIC"))
summary(ur.df(res.ols, type = "trend",
selectlags = "BIC", lags = 12))
summary(ur.df(res.dols, type = "trend",
selectlags = "BIC", lags = 12))
coef(ols.fit)
ecm <- dynlm(diff(low.ts) ~ diff(high.ts) + L(res.ols))
summary(ecm)
library(vars)
bdf = read_xlsx("3MAAPL.xlsx")
bdf = read_xlsx("3MAAPL.xlsx")
mm = ts(log(bdf$MMM))
aa = ts(log(bdf$AAPL))
colnames(bdf)
bts = ts(log(bdf[,-1]))
head(bts)
bdf = read_xlsx("3MAAPL.xlsx")
bts = ts(log(bdf[,-1]))
par(mfrow = c(2,1))
for(i in 1:NCOL(bts)){
plot(bts[,i], main = colnames(bts)[i])
}
par(mfrow = c(1,1))
par(mfrow = c(2,1))
for(i in 1:NCOL(bts)){
acf(bts[,i], main = colnames(bts)[i])
}
par(mfrow = c(1,1))
par(mfrow = c(2,1))
for(i in 1:NCOL(bts)){
acf(bts[,i], main = colnames(bts)[i])
}
par(mfrow = c(1,1))
par(mfrow = c(2,1))
for(i in 1:NCOL(bts)){
acf(bts[,i], main = colnames(bts)[i])
}
par(mfrow = c(1,1))
par(mfrow = c(2,1))
for(i in 1:NCOL(bts)){
pacf(bts[,i], main = colnames(bts)[i])
}
par(mfrow = c(1,1))
ccf(bts)
ccf(bts[,1], bts[,2])
?bts
ccf(bts[,1], bts[,2])
bdf = read_xlsx("3MAAPL.xlsx")
bts = ts(log(bdf[,-1]))
bts = ts(log(bdf[,-1]))
### B1
Grafici
for(i in 1:NCOL(bts)){
plot(bts[,i], main = colnames(bts)[i])
}
par(mfrow = c(2,1))
for(i in 1:NCOL(bts)){
acf(bts[,i], main = colnames(bts)[i])
}
par(mfrow = c(2,1))
for(i in 1:NCOL(bts)){
pacf(bts[,i], main = colnames(bts)[i])
}
par(mfrow = c(1,1))
bdf = read_xlsx("3MAAPL.xlsx")
bts = ts(diff(log(bdf[,-1])))
bdf = read_xlsx("3MAAPL.xlsx")
bts = ts(apply(log(bdf[,-1]), 2, diff))
par(mfrow = c(2,1))
for(i in 1:NCOL(bts)){
plot(bts[,i], main = colnames(bts)[i])
}
par(mfrow = c(1,1))
par(mfrow = c(2,1))
for(i in 1:NCOL(bts)){
acf(bts[,i], main = colnames(bts)[i])
}
par(mfrow = c(1,1))
par(mfrow = c(2,1))
for(i in 1:NCOL(bts)){
pacf(bts[,i], main = colnames(bts)[i])
}
par(mfrow = c(1,1))
ccf(bts[,1], bts[,2])
ccf(bts[,1], bts[,2])
VARselect(bts, lag.max = 12, type = "const")
VARselect(bts, lag.max = 12, type = "const") %>% summary
VARselect(bts, lag.max = 12, type = "const")
mod1 = VAR(bts, p = 1, type = "const")
mod1 %>% summary
root.matrix(mod1)
roots(mod1)
var.res = res(mod1)
var.res = resid(mod1)
?Box.test
Box.test(var.res, lag = 1, type = "Ljung-Box")
var.res = residuals(mod1)
Box.test(var.res, lag = 1, type = "Ljung-Box")
head(var.res)
var.res = ts(residuals(mod1))
Box.test(var.res, lag = 1, type = "Ljung-Box")
Box.test(var.res[,1], lag = 1, type = "Ljung-Box")
Box.test(var.res[,1], lag = 1, type = "Ljung-Box")
Box.test(var.res[,2], lag = 1, type = "Ljung-Box")
Box.test(var.res[,1], lag = 5, type = "Ljung-Box")
Box.test(var.res[,2], lag = 5, type = "Ljung-Box")
setwd("C:/Users/pietr/OneDrive - Università degli Studi di Padova/UNI/Corsi/Magistrale/Secondo Anno/Primo semestre/Modelli statistici per dati economici/Esami/Appello del 1 febbraio 2024-20250609")
rm(list = ls())
library(urca)
library(vars)
library(dplyr)
library(urca)
library(vars)
library(dplyr)
cvdf <- read.csv("CVXprice.csv", header = T)
head(cvdf)
cvdf <- read.csv("CVXprice.csv", header = T)
ll = ts(log(cvdf$Low))
lh = ts(log(cvdf$High))
ur.df(ll, type = "trend", lags = 12, selectlags = "BIC") %>% summary
ur.df(diff(ll), lags = 0)
ur.df(diff(ll), lags = 0) %>% summary
ur.df(diff(ll), lags = 0) %>% summary
ur.df(lh, type = "trend", lags = 12, selectlags = "BIC") %>% summary
ur.df(diff(lh), lags = 0) %>% summary
ols.fit = lm(ll ~ lh)
res.ols = residuals(ols.fit)
par(mfrow = c(3,1))
plot(res.ols)
acf(res.ols)
pacf(res.ols)
par(mfrow = c(1,1))
ols.fit = lm(ll ~ lh)
res.ols = ts(residuals(ols.fit))
par(mfrow = c(3,1))
plot(res.ols)
acf(res.ols)
pacf(res.ols)
par(mfrow = c(1,1))
library(dynlm)
# scelta euristica del lag
lmax = ceiling(1/3 * length(ll)^(1(3)))
# scelta euristica del lag
lmax = ceiling(1/3 * length(ll)^(1/3))
lmax
# scelta euristica del lag
lmax = ceiling(1/3 * length(ll)^(1/3))
dols.fit = dynlm(ll ~ lh + L(res.ols, -lmax:lmax))
res.dols = ts(residuals(dols.fit))
par(mfrow = c(3,1))
plot(res.dls)
acf(res.dols)
pacf(res.dols)
par(mfrow = c(1,1))
par(mfrow = c(3,1))
plot(res.dols)
acf(res.dols)
pacf(res.dols)
par(mfrow = c(1,1))
ols.fit %>% summary
ecm.ols = dynlm(diff(ll) ~ diff(lh) + L(res.ols, 1))
ecm.ols %>% summary
ecm.ols.1 = dynlm(diff(ll) ~ -1 + diff(lh) + L(res.ols, 1))
ecm.ols.1 %>% summary
ur.df(res.ols, lags = 0)
ur.df(res.ols, lags = 1)
ur.df(res.ols, lags = 0) %>% summary
c(1, coef(ols.fit))
coef(ecm.ols.1)[1]
coef(ecm.ols.1)[2]
xodf  <- read.csv("XOMCVX.csv", header = T)
xo.ts <- ts(xodf[,-1])
head(xo.ts)
xodf  <- read.csv("XOMCVX.csv", header = T)
xo.ts <- ts(log(xodf[,-1]))
head(xo.ts)
par(mfrow = c(3,1))
plot(xo.ts[,1], main = "mmm")
acf(xo.ts[,1], main = "mmm")
pacf(xo.ts[,1], main = "mmm")
par(mfrow = c(1,1))
par(mfrow = c(3,1))
plot(xo.ts[,2], main = "aapl")
acf(xo.ts[,2], main = "aapl")
pacf(xo.ts[,2], main = "aapl")
par(mfrow = c(1,1))
ccf(xo.ts[,1], xo.ts[,2], lag.max = 10)
xo.ts <- ts(diff(log(xodf[,-1])))
xo.ts <- apply(log(xodf[,-1]), 2, diff) %>% ts
head(xo.ts)
par(mfrow = c(3,1))
plot(xo.ts[,1], main = "mmm")
acf(xo.ts[,1], main = "mmm")
pacf(xo.ts[,1], main = "mmm")
par(mfrow = c(1,1))
par(mfrow = c(3,1))
plot(xo.ts[,2], main = "aapl")
acf(xo.ts[,2], main = "aapl")
pacf(xo.ts[,2], main = "aapl")
par(mfrow = c(1,1))
ccf(xo.ts[,1], xo.ts[,2], lag.max = 10)
library(vars)
VARselect(xo.ts, lag.max = 12, type = "const")
VARselect(xo.ts, lag.max = 12, type = "const")
VARselect(xo.ts, lag.max = 12, type = "none")
VARselect(xo.ts, lag.max = 12, type = "const")$criteria[,2]
VARselect(xo.ts, lag.max = 12, type = "const")$criteria[,2]
VARselect(xo.ts, lag.max = 12, type = "none")$criteria[,2]
var.noint <- VAR(xo.ts, p = 2, type = "none")
var.yesint <- VAR(xo.ts, p = 2, type = "const")
var.noint %>% summary
var.yesint %>% summary
var.noint %>% summary
roots(var.noint)
res.var = residuals(var.noint)
res.var = ts(residuals(var.noint))
?serial.test
serial.test(res.var, lags.pt = 12)
serial.test(var.noint, lags.pt = 12)
normality.test(var.noint)
?irf
irf(var.noint, ortho = T, n.ahead = 5)
irf(var.noint, ortho = T, n.ahead = 5) %>% plot
par(mfrow = c(2,1))
irf(var.noint, ortho = T, n.ahead = 5) %>% plot
par(mfrow = c(1,1))
par(mfrow = c(2,1))
irf(var.noint[,2:1], ortho = T, n.ahead = 5) %>% plot
par(mfrow = c(2,1))
irf(var.noint, ortho = T, n.ahead = 5,
plot.type = "single") %>% plot
par(mfrow = c(1,1))
irf_ortho<-irf(var.noint,ortho=TRUE, n.ahead=5)
par(mfrow= c(2,2),mgp=c(1,0.5,0),mar=c(3,2,2,1)+0.1)
plot(irf_ortho,plot.type="single",
cex.lab=0.5,cex.axis=0.5,cex.main=0.5,cex.sub=0.5)
setwd("C:/Users/pietr/OneDrive - Università degli Studi di Padova/UNI/Corsi/Magistrale/Secondo Anno/Primo semestre/Modelli statistici per dati economici/Esami/Appello del 22 febbraio 2024-20250609")
rm(list = ls())
library(dplyr)
library(vars)
library(urca)
library(dynlm)
library(dplyr)
mydf <- read.csv("exports_UKJ.csv", header = T)
e.ts <- ts(mydf[,-1], start = c(1992, 1), frequency = 12)
end(e.ts)
colnames(e.ts)
par(mfrow = c(3,3))
for(i in 1:NCOL(e.ts)){
plot(e.ts[,i], main = colnames(e.ts)[i])
acf(e.ts[,i], main = colnames(e.ts)[i])
pacf(e.ts[,i], main = colnames(e.ts)[i])
}
par(mfrow = c(1,1))
par(mfrow = c(3,2))
for(i in 1:NCOL(e.ts)){
for(j in (i+1):NCOL(e.ts)){
ccf(e.ts[,i], e.ts[,j],
main = paste0(colnames(e.ts)[i], " ", colnames(e.ts)[j],
collapse = T))
}
}
par(mfrow = c(1,1))
par(mfrow = c(3,2))
for(i in 1:NCOL(e.ts)){
for(j in (i+1):NCOL(e.ts)){
ccf(e.ts[,i], e.ts[,j],
main = paste0(colnames(e.ts)[i], " ", colnames(e.ts)[j],
collapse = ""))
}
}
par(mfrow = c(1,1))
par(mfrow = c(3,1))
for(i in 1:NCOL(e.ts)){
for(j in (i+1):NCOL(e.ts)){
ccf(e.ts[,i], e.ts[,j],
main = paste0(colnames(e.ts)[i], " ", colnames(e.ts)[j],
collapse = ""))
}
}
par(mfrow = c(1,1))
par(mfrow = c(3,1))
for(i in 1:(NCOL(e.ts) - 1)){
for(j in (i+1):NCOL(e.ts)){
ccf(e.ts[,i], e.ts[,j],
main = paste0(colnames(e.ts)[i], " ", colnames(e.ts)[j],
collapse = ""))
}
}
par(mfrow = c(1,1))
usa <- ts(e.ts[,1])
head(usa)
colnames(e.ts)
usa <- ts(e.ts[,1])
korea <- ts(e.ts[,2])
japan <- ts(e.ts[,3])
usa %>% ur.df(type = "trend", lags = 12, selectlags = "BIC") %>% summary
usa %>% ur.df(type = "drift", lags = 12, selectlags = "BIC") %>% summary
usa %>% ur.df(type = "none", lags = 12, selectlags = "BIC") %>% summary
usa %>% diff %>%  ur.df(type = "none", lags = 0) %>% summary
korea %>% ur.df(type = "trend", lags = 12, selectlags = "BIC") %>% summary
korea %>% ur.df(type = "drift", lags = 12, selectlags = "BIC") %>% summary
korea %>% ur.df(type = "none", lags = 12, selectlags = "BIC") %>% summary
korea %>% diff %>%  ur.df(type = "none", lags = 0) %>% summary
japan %>% ur.df(type = "trend", lags = 12, selectlags = "BIC") %>% summary
japan %>% ur.df(type = "drift", lags = 12, selectlags = "BIC") %>% summary
japan %>% ur.df(type = "none", lags = 12, selectlags = "BIC") %>% summary
japan %>% diff %>%  ur.df(type = "none", lags = 0) %>% summary
?ca.jo
ca.jo(e.ts, type = "trace", K = 3, ecdet = "const") %>% summary
ca.jo(e.ts, type = "trace", K = 3, ecdet = "none") %>% summary
ca.jo(e.ts, type = "trace", K = 4, ecdet = "none") %>% summary
ca.jo(e.ts, type = "trace", K = 12, ecdet = "none") %>% summary
ca.jo(e.ts, type = "trace", K = 6, ecdet = "none") %>% summary
VARselect(e.ts)
ca.jo(e.ts, type = "trace", K = 3, ecdet = "none") %>% summary
ca.jo.res <- ca.jo(e.ts, type = "trace", K = 3, ecdet = "none")
ca.jo.res %>% summary
t = ca.jo.res %>% summary
str(t)
vecm <- ca.jo(e.ts, type = "trace", K = 3, ecdet = "none")
vecm %>% summary
vecm1 <- cajorls(vecm, r = 1)
?cajorls
vecm1$beta
